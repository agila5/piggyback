<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Piggyback Data atop your GitHub Repository! • piggyback</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Piggyback Data atop your GitHub Repository!">
<meta property="og:description" content="piggyback">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">piggyback</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/alternatives.html">Piggyback comparison to alternatives</a>
    </li>
    <li>
      <a href="../articles/intro.html">Piggyback Data atop your GitHub Repository!</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ropensci/piggyback/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Piggyback Data atop your GitHub Repository!</h1>
                        <h4 data-toc-skip class="author">Carl Boettiger</h4>

            <h4 data-toc-skip class="date">2022-02-09</h4>

      <small class="dont-index">Source: <a href="https://github.com/ropensci/piggyback/blob/HEAD/vignettes/intro.Rmd" class="external-link"><code>vignettes/intro.Rmd</code></a></small>
      <div class="hidden name"><code>intro.Rmd</code></div>

    </div>



<div class="section level1">
<h1 id="why-piggyback">Why <code>piggyback</code>?<a class="anchor" aria-label="anchor" href="#why-piggyback"></a>
</h1>
<p><code>piggyback</code> grew out of the needs of students both in my classroom and in my research group, who frequently need to work with data files somewhat larger than one can conveniently manage by committing directly to GitHub. As we frequently want to share and run code that depends on &gt;50MB data files on each of our own machines, on continuous integration, and on larger computational servers, data sharing quickly becomes a bottleneck.</p>
<p><a href="https://docs.github.com/en/github/managing-large-files/distributing-large-binaries" class="external-link">GitHub allows</a> repositories to attach files of up to 2 GB each to releases as a way to distribute large files associated with the project source code. There is no limit on the number of files or bandwidth to deliver them.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install the latest release from CRAN using:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"piggyback"</span><span class="op">)</span></code></pre></div>
<p>You can install the development version from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("devtools")</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/remote-reexports.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"ropensci/piggyback"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="authentication">Authentication<a class="anchor" aria-label="anchor" href="#authentication"></a>
</h2>
<p>No authentication is required to download data from <em>public</em> GitHub repositories using <code>piggyback</code>. Nevertheless, <code>piggyback</code> recommends setting a token when possible to avoid rate limits. To upload data to any repository, or to download data from <em>private</em> repositories, you will need to authenticate first.</p>
<p>To do so, add your <a href="https://github.com/settings/tokens/new?scopes=repo,gist&amp;description=R:GITHUB_PAT" class="external-link">GitHub Token</a> to an environmental variable, e.g. in a <code>.Renviron</code> file in your home directory or project directory (any private place you won’t upload), see <code><a href="https://usethis.r-lib.org/reference/edit.html" class="external-link">usethis::edit_r_environ()</a></code>. For one-off use you can also set your token from the R console using:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span>GITHUB_PAT<span class="op">=</span><span class="st">"xxxxxx"</span><span class="op">)</span></code></pre></div>
<p>But try to avoid putting <code><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv()</a></code> in any R scripts – remember, the goal here is to avoid writing your private token in any file that might be shared, even privately.</p>
<p>For more information, please see the <a href="https://usethis.r-lib.org/articles/git-credentials.html" class="external-link">usethis guide to GitHub credentials</a></p>
</div>
<div class="section level2">
<h2 id="downloading-data">Downloading data<a class="anchor" aria-label="anchor" href="#downloading-data"></a>
</h2>
<p>Download the latest version or a specific version of the data:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/piggyback" class="external-link">piggyback</a></span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pb_download.html">pb_download</a></span><span class="op">(</span><span class="st">"iris2.tsv.gz"</span>,
            repo <span class="op">=</span> <span class="st">"cboettig/piggyback-tests"</span>,
            tag <span class="op">=</span> <span class="st">"v0.0.1"</span>,
            dest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><strong>Note</strong>: Whenever you are working from a location inside a git repository corresponding to your GitHub repo, you can simply omit the <code>repo</code> argument and it will be detected automatically. Likewise, if you omit the release <code>tag</code>, <code>the</code>pb_download<code>will simply pull data from most recent release (</code>latest<code>).  Third, you can omit</code>tempdir()<code>if you are using an RStudio Project (</code>.Rproj<code>file) in your repository, and then the download location will be relative to Project root.</code>tempdir()` is used throughout the examples only to meet CRAN policies and is unlikely to be the choice you actually want here.</p>
<p>Lastly, simply omit the file name to download all assets connected with a given release.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pb_download.html">pb_download</a></span><span class="op">(</span>repo <span class="op">=</span> <span class="st">"cboettig/piggyback-tests"</span>,
            tag <span class="op">=</span> <span class="st">"v0.0.1"</span>,
            dest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>These defaults mean that in most cases, it is sufficient to simply call <code><a href="../reference/pb_download.html">pb_download()</a></code> without additional arguments to pull in any data associated with a project on a GitHub repo that is too large to commit to git directly.</p>
<p><code><a href="../reference/pb_download.html">pb_download()</a></code> will skip the download of any file that already exists locally if the timestamp on the local copy is more recent than the timestamp on the GitHub copy. <code><a href="../reference/pb_download.html">pb_download()</a></code> also includes arguments to control the timestamp behavior, progress bar, whether existing files should be overwritten, or if any particular files should not be downloaded. See function documentation for details.</p>
<p>Sometimes it is preferable to have a URL from which the data can be read in directly, rather than downloading the data to a local file. For example, such a URL can be embedded directly into another R script, avoiding any dependence on <code>piggyback</code> (provided the repository is already public.) To get a list of URLs rather than actually downloading the files, use <code><a href="../reference/pb_download_url.html">pb_download_url()</a></code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pb_download_url.html">pb_download_url</a></span><span class="op">(</span><span class="st">"data/mtcars.tsv.gz"</span>,
                repo <span class="op">=</span> <span class="st">"cboettig/piggyback-tests"</span>,
                tag <span class="op">=</span> <span class="st">"v0.0.1"</span><span class="op">)</span> </code></pre></div>
</div>
<div class="section level2">
<h2 id="uploading-data">Uploading data<a class="anchor" aria-label="anchor" href="#uploading-data"></a>
</h2>
<p>If your GitHub repository doesn’t have any <a href="https://docs.github.com/en/github/administering-a-repository/managing-releases-in-a-repository" class="external-link">releases</a> yet, <code>piggyback</code> will help you quickly create one. Create new releases to manage multiple versions of a given data file. While you can create releases as often as you like, making a new release is by no means necessary each time you upload a file. If maintaining old versions of the data is not useful, you can stick with a single release and upload all of your data there.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pb_new_release.html">pb_new_release</a></span><span class="op">(</span><span class="st">"cboettig/piggyback-tests"</span>, <span class="st">"v0.0.2"</span><span class="op">)</span></code></pre></div>
<p>Once we have at least one release available, we are ready to upload. By default, <code>pb_upload</code> will attach data to the latest release.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## We'll need some example data first.</span>
<span class="co">## Pro tip: compress your tabular data to save space &amp; speed upload/downloads</span>
<span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_tsv</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="st">"mtcars.tsv.gz"</span><span class="op">)</span>

<span class="fu"><a href="../reference/pb_upload.html">pb_upload</a></span><span class="op">(</span><span class="st">"mtcars.tsv.gz"</span>,
          repo <span class="op">=</span> <span class="st">"cboettig/piggyback-tests"</span>,
          tag <span class="op">=</span> <span class="st">"v0.0.1"</span><span class="op">)</span></code></pre></div>
<p>Like <code><a href="../reference/pb_download.html">pb_download()</a></code>, <code><a href="../reference/pb_upload.html">pb_upload()</a></code> will overwrite any file of the same name already attached to the release file by default, unless the timestamp the previously uploaded version is more recent. You can toggle these settings with <code>overwrite=FALSE</code> and <code>use_timestamps=FALSE</code>.</p>
</div>
<div class="section level2">
<h2 id="additional-convenience-functions">Additional convenience functions<a class="anchor" aria-label="anchor" href="#additional-convenience-functions"></a>
</h2>
<p>List all files currently piggybacking on a given release. Omit the <code>tag</code> to see files on all releases.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pb_list.html">pb_list</a></span><span class="op">(</span>repo <span class="op">=</span> <span class="st">"cboettig/piggyback-tests"</span>,
        tag <span class="op">=</span> <span class="st">"v0.0.1"</span><span class="op">)</span></code></pre></div>
<p>Delete a file from a release:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pb_delete.html">pb_delete</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"mtcars.tsv.gz"</span>,
          repo <span class="op">=</span> <span class="st">"cboettig/piggyback-tests"</span>,
          tag <span class="op">=</span> <span class="st">"v0.0.1"</span><span class="op">)</span></code></pre></div>
<p>Note that this is irreversible unless you have a copy of the data elsewhere.</p>
</div>
<div class="section level2">
<h2 id="multiple-files">Multiple files<a class="anchor" aria-label="anchor" href="#multiple-files"></a>
</h2>
<p>You can pass in a vector of file paths with something like <code><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files()</a></code> to the <code>file</code> argument of <code><a href="../reference/pb_upload.html">pb_upload()</a></code> in order to upload multiple files. Some common patterns:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span>

<span class="co">## upload a folder of data</span>
<span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="st">"data"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/pb_upload.html">pb_upload</a></span><span class="op">(</span>repo <span class="op">=</span> <span class="st">"cboettig/piggyback-tests"</span>, tag <span class="op">=</span> <span class="st">"v0.0.1"</span><span class="op">)</span>

<span class="co">## upload certain file extensions</span>
<span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"*.tsv.gz"</span>, <span class="st">"*.tif"</span>, <span class="st">"*.zip"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/pb_upload.html">pb_upload</a></span><span class="op">(</span>repo <span class="op">=</span> <span class="st">"cboettig/piggyback-tests"</span>, tag <span class="op">=</span> <span class="st">"v0.0.1"</span><span class="op">)</span></code></pre></div>
<p>Similarly, you can download all current data assets of the latest or specified release by using <code><a href="../reference/pb_download.html">pb_download()</a></code> with no arguments.</p>
</div>
<div class="section level2">
<h2 id="caching">Caching<a class="anchor" aria-label="anchor" href="#caching"></a>
</h2>
<p>To reduce API calls to GitHub, piggyback caches most calls with a timeout of 1 second by default. This avoids repeating identical requests to update it’s internal record of the repository data (releases, assets, timestamps, etc) during programmatic use. You can increase or decrease this delay by setting the environmental variable in seconds, e.g. <code>Sys.setenv("piggyback_cache_duration"=10)</code> for a longer delay or <code>Sys.setenv("piggyback_cache_duration"=0)</code> to disable caching.</p>
</div>
<div class="section level2">
<h2 id="valid-file-names">Valid file names<a class="anchor" aria-label="anchor" href="#valid-file-names"></a>
</h2>
<p>GitHub assets attached to a release do not support file paths, and will convert most special characters (<code>#</code>, <code>%</code>, etc) to <code>.</code> or throw an error (e.g. for file names containing <code>$</code>, <code>@</code>, <code>/</code>). piggyback will default to using the base name of the file only (i.e. will only use <code>"mtcars.csv"</code> if provided a file path like <code>"data/mtcars.csv"</code>)</p>
</div>
<div class="section level2">
<h2 id="a-note-on-github-releases-vs-data-archiving">A Note on GitHub Releases vs Data Archiving<a class="anchor" aria-label="anchor" href="#a-note-on-github-releases-vs-data-archiving"></a>
</h2>
<p><code>piggyback</code> is not intended as a data archiving solution. Importantly, bear in mind that there is nothing special about multiple “versions” in releases, as far as data assets uploaded by <code>piggyback</code> are concerned. The data files <code>piggyback</code> attaches to a Release can be deleted or modified at any time – creating a new release to store data assets is the functional equivalent of just creating new directories <code>v0.1</code>, <code>v0.2</code> to store your data. (GitHub Releases are always pinned to a particular <code>git</code> tag, so the code/git-managed contents associated with repo are more immutable, but remember our data assets just piggyback on top of the repo).</p>
<p>Permanent, published data should always be archived in a proper data repository with a DOI, such as <a href="https://zenodo.org" class="external-link">zenodo.org</a>. Zenodo can freely archive public research data files up to 50 GB in size, and data is strictly versioned (once released, a DOI always refers to the same version of the data, new releases are given new DOIs). <code>piggyback</code> is meant only to lower the friction of working with data during the research process. (e.g. provide data accessible to collaborators or continuous integration systems during research process, including for private repositories.)</p>
</div>
<div class="section level2">
<h2 id="what-will-github-think-of-this">What will GitHub think of this?<a class="anchor" aria-label="anchor" href="#what-will-github-think-of-this"></a>
</h2>
<p><a href="https://docs.github.com/en/github/managing-large-files/distributing-large-binaries" class="external-link">GitHub documentation</a> at the time of writing endorses the use of attachments to releases as a solution for distributing large files as part of your project:</p>
<p><img src="https://github.com/ropensci/piggyback/raw/83776863b34bb1c9962154608a5af41867a0622f/reference/figures/github-policy.png"></p>
<p>Of course, it will be up to GitHub to decide if this use of release attachments is acceptable in the long term.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Carl Boettiger.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
